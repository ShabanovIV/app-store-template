"use strict";(self.webpackChunkapp_store=self.webpackChunkapp_store||[]).push([[781],{8781:(e,s,r)=>{r.r(s),r.d(s,{default:()=>j});var a=r(4848),n=r(6540),o=r(1667),t=r(6552),i=r(2702),c=r(515),l=r(9220),d=r(9365),u=r(4716),m=r(9862),w=r(7231),p=r(1458);const f=()=>{const[e,s]=(0,n.useState)(!1),[r]=l.A.useForm(),{data:o,update:t,isUpdateSuccess:i,isLoading:f,isUpdating:h}=(e=>{const{data:s,refetch:r,isLoading:a,isSuccess:n,error:o}=(0,m.v4)(),[t,{isLoading:i,isSuccess:c,error:l}]=(0,m.d2)();return(0,w.u)({form:e,error:o}),(0,w.u)({form:e,error:l}),(0,p.j)({isSuccess:c,mess:"Data saved successfully"}),{data:s,refetch:r,update:e=>{return s=void 0,r=void 0,n=function*(){yield t({name:e})},new((a=void 0)||(a=Promise))((function(e,o){function t(e){try{c(n.next(e))}catch(e){o(e)}}function i(e){try{c(n.throw(e))}catch(e){o(e)}}function c(s){var r;s.done?e(s.value):(r=s.value,r instanceof a?r:new a((function(e){e(r)}))).then(t,i)}c((n=n.apply(s,r||[])).next())}));var s,r,a,n},isLoading:a,isUpdating:i,isUpdateSuccess:c,isSuccess:n}})(r);return(0,n.useEffect)((()=>{o&&r.setFieldsValue(o)}),[o,r]),(0,n.useEffect)((()=>{i&&s(!1)}),[i]),(0,a.jsxs)(l.A,{form:r,name:"ProfileForm",labelAlign:"left",labelCol:{span:8},wrapperCol:{span:16},onFinish:e=>{t(e.name)},autoComplete:"off",children:[(0,a.jsx)(l.A.Item,{label:"Full Name",name:"name",rules:[{required:!0,message:"Please enter your username"},{min:3,max:20,message:"Username must be between 3 and 20 characters"},{pattern:/^[a-zA-Z0-9_]+$/,message:"Username can only contain letters, numbers, and underscores"}],children:(0,a.jsx)(d.A,{onChange:()=>{s(!0)},placeholder:"John Doe"})}),(0,a.jsx)(l.A.Item,{label:"Email",name:"email",children:(0,a.jsx)(d.A,{readOnly:!0})}),(0,a.jsx)(l.A.Item,{label:"Date of Registration",name:"signUpDate",children:(0,a.jsx)(d.A,{readOnly:!0})}),(0,a.jsx)(c.Ay,{type:"primary",htmlType:"submit",style:{width:"100%"},disabled:f||h||!e,children:f?(0,a.jsx)(u.A,{}):"Save"})]})};var h=r(4870);const x=(e,s)=>({password:(0,h.Q)(h.C.password),newPassword:(0,h.Q)(h.C.password),confirm:[{required:!0,message:"Please confirm your password"},{validator:(e,r,a)=>{r&&r!==s.getFieldValue("newPassword")?a("Passwords do not match"):a()}}]}[e]);const y=({onSuccess:e})=>{const[s]=l.A.useForm(),{changePass:r,isLoading:o,isSuccess:t}=(e=>{const[s,{isLoading:r,isSuccess:a,error:n}]=(0,m.SV)();return(0,w.u)({form:e,error:n}),(0,p.j)({isSuccess:a,mess:"Password successfully changed"}),{changePass:(e,r)=>{return a=void 0,n=void 0,t=function*(){yield s({password:e,newPassword:r})},new((o=void 0)||(o=Promise))((function(e,s){function r(e){try{c(t.next(e))}catch(e){s(e)}}function i(e){try{c(t.throw(e))}catch(e){s(e)}}function c(s){var a;s.done?e(s.value):(a=s.value,a instanceof o?a:new o((function(e){e(a)}))).then(r,i)}c((t=t.apply(a,n||[])).next())}));var a,n,o,t},isLoading:r,isSuccess:a}})(s);return(0,n.useEffect)((()=>{t&&e&&e()}),[t,e]),(0,a.jsxs)(l.A,{form:s,name:"ProfilePwdForm",labelAlign:"left",labelCol:{span:8},wrapperCol:{span:16},onFinish:e=>{r(e.password,e.newPassword)},autoComplete:"off",children:[(0,a.jsx)(l.A.Item,{label:"Current Password",name:"password",rules:x("password",s),children:(0,a.jsx)(d.A.Password,{placeholder:"Enter current password"})}),(0,a.jsx)(l.A.Item,{label:"New Password",name:"newPassword",rules:x("newPassword",s),children:(0,a.jsx)(d.A.Password,{placeholder:"Enter new password"})}),(0,a.jsx)(l.A.Item,{label:"Confirm password",name:"confirm",rules:x("confirm",s),children:(0,a.jsx)(d.A.Password,{placeholder:"Confirm password"})}),(0,a.jsx)(c.Ay,{type:"primary",htmlType:"submit",style:{width:"100%"},disabled:o,children:o?(0,a.jsx)(u.A,{}):"Change"})]})},{Text:g}=o.A,P=()=>{const[e,s]=(0,n.useState)(!0);return(0,a.jsxs)("div",{className:"ProfileSwitcher-module_profileCard-K0Zcw",children:[(0,a.jsx)("h4",{className:"ProfileSwitcher-module_title-E5qJI",children:e?"Personal data":"Password change"}),e?(0,a.jsx)(f,{}):(0,a.jsx)(y,{}),(0,a.jsx)(t.A,{}),(0,a.jsxs)(i.A,{direction:"vertical",align:"center",style:{width:"100%"},children:[(0,a.jsx)(g,{type:"secondary",children:e?"Want to change your password?":""}),(0,a.jsx)(c.Ay,{type:"link",onClick:()=>{s((e=>!e))},children:e?"Password change":"Back to Profile"})]})]})},j=()=>(0,a.jsx)(P,{})},7231:(e,s,r)=>{r.d(s,{u:()=>t});var a=r(6540),n=r(3448),o=r(5515);const t=({form:e,error:s})=>{const{showError:r}=(0,n.J)();(0,a.useEffect)((()=>{if(s){(0,o.jS)(s),e&&e.setFields((0,o.z6)(s));const a=(0,o.bu)(s);a&&r(a)}}),[s,e,r])}},3448:(e,s,r)=>{r.d(s,{J:()=>o});var a=r(6540),n=r(582);const o=()=>{const e=(0,a.useContext)(n.N);if(!e)throw new Error("useMessage должен использоваться внутри <MessageProvider>");return e}},1458:(e,s,r)=>{r.d(s,{j:()=>o});var a=r(6540),n=r(3448);const o=({isSuccess:e,mess:s})=>{const{showSuccess:r}=(0,n.J)();(0,a.useEffect)((()=>{e&&r(s)}),[e,s,r])}},4870:(e,s,r)=>{r.d(s,{C:()=>a,Q:()=>n});const a={email:"email",password:"password"},n=e=>({email:[{required:!0,message:"Please input your email"},{pattern:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,message:"Please enter a valid email address"}],password:[{required:!0,message:"Please enter your password"}]}[e])}}]);
//# sourceMappingURL=781.7dacc52161ac7b1ff744.js.map